#!/usr/bin/env bash
#######################
qemu_main() {
	case "$1" in
	-x64qemu)
		start_tmoe_qemu_tool
		;;
	-arm64qemu)
		start_tmoe_qemu_aarch64_manager
		;;
	-m | *)
		install_container_and_virtual_machine
		;;
	esac
}
############
qemu_system_menu() {
	RETURN_TO_WHERE='qemu_system_menu'
	DEPENDENCY_01=''
	VIRTUAL_TECH=$(
		whiptail --title "qemu-system" --menu "æ‚¨æƒ³è¦é€‰æ‹©å“ªä¸€é¡¹å‘¢ï¼Ÿ" 0 0 0 \
			"1" "tmoe-qemu:x86_64/i386è™šæ‹Ÿæœºç®¡ç†" \
			"2" "virt-manager(GUIè™šæ‹Ÿæœºç®¡ç†å™¨)" \
			"3" "aqemu(QEMUå’ŒKVMçš„Qt5å‰ç«¯)" \
			"4" "gnome-boxes(ç®€å•åœ°ç®¡ç†è¿œç¨‹å’Œæœ¬åœ°è™šæ‹Ÿç³»ç»Ÿ)" \
			"0" "ðŸŒš Return to previous menu è¿”å›žä¸Šçº§èœå•" \
			3>&1 1>&2 2>&3
	)
	#############
	case ${VIRTUAL_TECH} in
	0 | "") install_container_and_virtual_machine ;;
	1) start_tmoe_qemu_tool ;;
	2) DEPENDENCY_02='virt-manager' ;;
	3) DEPENDENCY_02='aqemu' ;;
	4) DEPENDENCY_02='gnome-boxes' ;;
	esac
	#æœªå®‰è£…é¢å¤–è½¯ä»¶åŒ…,qemu-block-extra
	case ${VIRTUAL_TECH} in
	1) ;;
	*) beta_features_quick_install ;;
	esac
	###############
	press_enter_to_return
	qemu_system_menu
}
#############
start_tmoe_qemu_tool() {
	source ${TMOE_TOOL_DIR}/virtualization/qemu/tmoe-qemu
}
virtual_machine_iso_file() {
	source ${TMOE_TOOL_DIR}/virtualization/iso.sh
}
install_container_and_virtual_machine() {
	RETURN_TO_WHERE='install_container_and_virtual_machine'
	VIRTUAL_TECH=$(
		whiptail --title "è™šæ‹ŸåŒ–ä¸Žapiçš„è½¬æ¢" --menu "Which option do you want to choose?" 0 0 0 \
			"1" "ðŸ’» qemu:å¼€æºã€è·¨å¹³å°çš„è™šæ‹Ÿæœº" \
			"2" "ðŸ“€ iso/qcow2:ä¸‹è½½é•œåƒ(linux,win10)" \
			"3" "ðŸ³ docker:å¼€æºçš„åº”ç”¨å®¹å™¨å¼•æ“Ž" \
			"4" "ðŸ–¥ï¸ VirtualBox(ç”²éª¨æ–‡å¼€æºè™šæ‹Ÿæœºx64)" \
			"5" "ðŸ· wine:è°ƒç”¨win apiå¹¶å³æ—¶è½¬æ¢" \
			"6" "ðŸ¥¡ anbox(Android in a box)" \
			"0" "ðŸŒš Return to previous menu è¿”å›žä¸Šçº§èœå•" \
			"00" "Back to the main menu è¿”å›žä¸»èœå•" \
			3>&1 1>&2 2>&3
	)
	#############
	case ${VIRTUAL_TECH} in
	0 | "") beta_features ;;
	00) tmoe_linux_tool_menu ;;
	1) qemu_system_menu ;;
	2) virtual_machine_iso_file ;;
	3) tmoe_docker_menu ;;
	4) install_virtual_box ;;
	5) wine_menu ;;
	6) install_anbox ;;
	esac
	###############
	press_enter_to_return
	install_container_and_virtual_machine
}
#"4" "OpenMediaVault(åŸºäºŽdebiançš„NASç½‘ç»œè¿žæŽ¥å­˜å‚¨è§£å†³æ–¹æ¡ˆ)" \
#4) install_open_media_vault ;;
#####################
qemu_main "$@"
