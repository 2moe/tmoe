#!/usr/bin/env bash
########################
development_programming_tools() {
    RETURN_TO_WHERE='development_programming_tools'
    SOFTWARE=$(
        whiptail --title "Development" --menu \
            "æ‚¨æƒ³è¦å®‰è£…å“ªä¸ªè½¯ä»¶ï¼Ÿ\n Which software do you want to install?" 0 50 0 \
            "1" "ðŸ‡» ðŸ‡¸ VSCode çŽ°ä»£åŒ–ä»£ç ç¼–è¾‘å™¨" \
            "2" "ðŸ‡¦ ðŸ‡¸ Android-Studio(å®‰å“å¼€å‘å·¥å…·IDE)" \
            "3" "ðŸ‡® ðŸ‡¯ IntelliJ IDEA(javaç¼–ç¨‹è¯­è¨€é›†æˆå¼€å‘çŽ¯å¢ƒ)" \
            "4" "ðŸ‡µ ðŸ‡¾ PyCharm(pythoné›†æˆå¼€å‘çŽ¯å¢ƒ)" \
            "5" "ðŸ‡¼ ðŸ‡¸ Webstorm(JavaScript IDE,Webå‰ç«¯å¼€å‘å·¥å…·)" \
            "6" "ðŸ‡¨ ðŸ‡± CLion(C/C++é›†æˆå¼€å‘çŽ¯å¢ƒ)" \
            "7" "ðŸ‡¬ ðŸ‡´ GoLand(JetBrainsçš„Goå¼€å‘å·¥å…·)" \
            "8" "ðŸ‡¹ ðŸ‡¨ teamcity(æŒç»­é›†æˆContinue Integrationå·¥å…·)" \
            "0" "ðŸŒš Return to previous menu è¿”å›žä¸Šçº§èœå•" \
            3>&1 1>&2 2>&3
    )
    case "${SOFTWARE}" in
    0 | "") software_center ;;
    1) which_vscode_edition ;;
    2) install_android_studio ;;
    *) echo "æ–°ç‰ˆå³å°†é›†æˆæœ¬å¼€å‘å·¥å…·çš„å®‰è£…ï¼Œæ•¬è¯·æœŸå¾…" ;;
    esac
    ############################################
    press_enter_to_return
    development_programming_tools
}
###########
creat_android_studio_application_link() {
    cd ${APPS_LNK_DIR}
    #Icon=android-studio
    cat >android_studio.desktop <<-'EOF'
		[Desktop Entry]
		Name=Android Studio
		Type=Application
		Comment=Android Studio provides the fastest tools for building apps on every type of Android device.
		Exec=/opt/android-studio/bin/studio.sh %F
		Icon=/opt/android-studio/bin/studio.svg
		Categories=TextEditor;Development;IDE;
		MimeType=text/plain;inode/directory;
		Terminal=false
		Actions=new-empty-window;
		StartupNotify=true
		StartupWMClass=Android-Studio
	EOF
    chmod +x android_studio.desktop
}
#########################
download_android_studio() {
    THE_LATEST_DEB_LINK="$(curl -Lv 'https://developer.android.google.cn/studio/#downloads' | grep 'linux' | grep href | grep studio | tail -n 1 | cut -d '"' -f 2)"
    echo ${THE_LATEST_DEB_LINK}
    echo "Do you want to download and install it?"
    do_you_want_to_continue
    aria2c --allow-overwrite=true -s 10 -x 10 -k 1M -o android_studio_linux_64bit.tar.gz ${THE_LATEST_DEB_LINK}
}
###############
check_android_studio() {
    mkdir -p ${HOME}/sd/Download
    cd ${HOME}/sd/Download
    if [ -e "/opt/android-studio" ]; then
        echo 'æ‚¨å·²å®‰è£…Android studio'
        echo "è‹¥æ‚¨éœ€è¦å¸è½½ï¼Œåˆ™è¯·è¾“${RED}rm -rv${RESET} ${HOME}/sd/Download/android_studio_linux_64bit.tar.gz ${BLUE}/opt/android-studio ${APPS_LNK_DIR}/android_studio.desktop${RESET};${RED}${TMOE_REMOVAL_COMMAND}${RESET} ${BLUE}default-jre${RESET}"
        echo "æ˜¯å¦éœ€è¦é‡æ–°å®‰è£…ï¼Ÿ"
        echo "Do you want to reinstall it?"
        do_you_want_to_continue
    fi
    if [ ! -e "android_studio_linux_64bit.tar.gz" ]; then
        download_android_studio
    fi
    DEPENDENCY_01=''
    install_java
}
##############
install_android_studio() {
    check_android_studio
    tar -zxvf android_studio_linux_64bit.tar.gz -C /opt
    creat_android_studio_application_link
    echo "å®‰è£…åŒ…ä½äºŽ${BLUE}${HOME}/sd/Download/android_studio_linux_64bit.tar.gz${RESET}"
    echo "å®‰è£…å®Œæˆï¼Œå¦‚éœ€å¸è½½ï¼Œåˆ™è¯·è¾“${RED}rm -rv${RESET} ${BLUE}/opt/android-studio ${APPS_LNK_DIR}/android_studio.desktop${RESET};${RED}${TMOE_REMOVAL_COMMAND}${RESET} ${BLUE}default-jre${RESET}"
}
##################
development_programming_tools
