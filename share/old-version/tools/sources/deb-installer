####################
deb_batch_installer_tui_or_gui() {
    if (whiptail --title "GUI or TUI" --yes-button "GUI" --no-button "TUI" --yesno "æ‚¨æ˜¯æƒ³ç”¨å›¾å½¢ç”¨æˆ·ç•Œé¢,è¿˜æ˜¯æ–‡æœ¬ç”¨æˆ·ç•Œé¢å‘¢ï¼Ÿ\nDo you want to use GUI or TUI?\nè‹¥æ‚¨å¤„äºæ¡Œé¢ç¯å¢ƒä¸‹,åˆ™å»ºè®®é€‰æ‹©GUI,å¦åˆ™è¯·é€‰æ‹©TUIâ™ª(^âˆ‡^*) " 0 0); then
        gui_deb_batch_installer
    else
        tui_deb_batch_installer
    fi
}
#################
deb_installer_menu() {
    RETURN_TO_WHERE='deb_installer_menu'
    SOFTWARE=$(
        whiptail --title "TMOE-DEB-INSTALLER" --menu \
            "è½¯ä»¶åŒ…å®‰è£…ä¸å¸è½½ç®¡ç†å™¨" 0 0 0 \
            "1" "batch-installationæ‰¹é‡å®‰è£…" \
            "2" "å•ç‹¬å®‰è£…å¹¶æ£€æµ‹å¸è½½å‘½ä»¤" \
            "0" "ğŸŒš Back to the main menu è¿”å›ä¸»èœå•" \
            3>&1 1>&2 2>&3
    )
    case "${SOFTWARE}" in
    0 | "") tmoe_software_package_menu ;;
    1) deb_batch_installer_tui_or_gui ;;
    2) tmoe_deb_file_installer ;;
    esac
    ############################################
    press_enter_to_return
    deb_installer_menu
}
###########
tmoe_deb_batch_installer_01() {
    DEPENDENCY_02=""
    for TMOE_DEB_FILE in *deb; do
        apt-cache show ./${TMOE_DEB_FILE}
        PACKAGE_NAME=$(apt-cache show ./${TMOE_DEB_FILE} 2>&1 | grep Package | head -n 1 | awk -F ' ' '$0=$NF')
        DEPENDENCY_01=${PACKAGE_NAME}
        apt install -y ./${TMOE_DEB_FILE}
        beta_features_install_completed
    done
}
#############
tmoe_deb_batch_installer_02() {
    DEPENDENCY_02=""
    for TMOE_DEB_FILE in *deb; do
        apt-cache show ./${TMOE_DEB_FILE}
        PACKAGE_NAME=$(apt-cache show ./${TMOE_DEB_FILE} 2>&1 | grep Package | head -n 1 | awk -F ' ' '$0=$NF')
        DEPENDENCY_01=${PACKAGE_NAME}
        apt install ./${TMOE_DEB_FILE}
        beta_features_install_completed
    done
}
#############
gui_deb_batch_installer() {
    check_zenity
    DEB_DIR=$(zenity --title "è¯·é€‰æ‹©debæ–‡ä»¶æ‰€åœ¨ç›®å½•ï¼Œå¹¶æŒ‰ç¡®è®¤é”®ï¼Œè¯¥ç›®å½•ä¸‹æ‰€æœ‰æ–‡ä»¶éƒ½å°†è¢«å®‰è£…ã€‚" --file-selection --directory)
    case "$?" in
    0) cd ${DEB_DIR} ;;
    *) ${RETURN_TO_WHERE} ;;
    esac
    zenity --question --title="tmoe-deb-installerçš„æç¤ºo(*ï¿£â–½ï¿£*)o" --text="${DEB_DIR} å†…çš„æ‰€æœ‰debæ–‡ä»¶å°†è¢«å®‰è£…ï¼" --ok-label="å¥½å“’" --cancel-label="æˆ‘çŸ¥é“å•¦"
    cd ${DEB_DIR}
    tmoe_deb_batch_installer_01
}
#########
check_deb_file_start_dir() {
    if [ -e "${HOME}/ä¸‹è½½" ]; then
        START_DIR="${HOME}/ä¸‹è½½"
    elif [ -e "/var/cache/apt/archives" ]; then
        START_DIR="/var/cache/apt/archives"
    else
        START_DIR="${HOME}"
    fi
}
############
tui_deb_batch_installer() {
    FILE_EXT_01='deb'
    FILE_EXT_02='DEB'
    check_deb_file_start_dir
    IMPORTANT_TIPS='ä»»æ„é€‰æ‹©ä¸€ä¸ªdebåŒ…,è¯¥æ–‡ä»¶å¤¹å†…çš„æ‰€æœ‰debåŒ…éƒ½å°†è¢«å®‰è£…'
    tmoe_file_manager
    if [ -z ${SELECTION} ]; then
        printf "%s\n" "æ²¡æœ‰æŒ‡å®š${YELLOW}æœ‰æ•ˆ${RESET}çš„${BLUE}æ–‡ä»¶${GREEN}ï¼Œè¯·${GREEN}é‡æ–°${RESET}é€‰æ‹©"
    else
        cd ${FILE_PATH}
        file ${SELECTION}
        printf "%s\n" "${FILE_PATH}å†…çš„${RED}æ‰€æœ‰debåŒ…${RESET}ï¼ˆä¸åŒ…å«å­ç›®å½•) éƒ½å°†è¢«å®‰è£…"
        do_you_want_to_continue
        tmoe_deb_batch_installer_02
    fi
}
###########
deb_file_installer() {
    #è¿›å…¥debæ–‡ä»¶ç›®å½•
    cd ${CURRENT_DIR}
    #./${SELECTION}
    case "${LINUX_DISTRO}" in
    "debian")
        file ./${SELECTION} 2>/dev/null
        apt-cache show ./${SELECTION}
        PACKAGE_NAME=$(apt-cache show ./${SELECTION} 2>&1 | grep Package | head -n 1 | awk -F ' ' '$0=$NF')
        printf "%s\n" "æ‚¨æ˜¯å¦éœ€è¦å®‰è£…æ­¤è½¯ä»¶åŒ…ï¼Ÿ"
        printf "%s\n" "Do you want to install it?"
        if [ $(command -v ${PACKAGE_NAME}) ]; then
            printf "%s\n" "æ£€æµ‹åˆ°æ‚¨${RED}å·²å®‰è£…${RESET}${BLUE}${PACKAGE_NAME}${RESET}"
            printf "%s\n" "If you want to ${RED}remove it${RESET}ï¼Œplease ${YELLOW}manually type ${PURPLE}apt purge ${BLUE}${PACKAGE_NAME}${RESET}"
            printf "%s\n" "æŒ‰${GREEN}å›è½¦é”®${RESET}${RED}é‡æ–°å®‰è£…${RESET}ã€‚"
            printf "%s\n" "è¾“${YELLOW}n${RESET}è¿”å›å¹¶è¿›å…¥${BLUE}å¸è½½èœå•${RESET}"
        fi
        RETURN_TO_WHERE='remove_deb_package'
        do_you_want_to_continue
        RETURN_TO_WHERE='deb_installer_menu'
        apt install -y ./${SELECTION}
        DEPENDENCY_01=${PACKAGE_NAME}
        DEPENDENCY_02=""
        beta_features_install_completed
        ;;
    *)
        if [ ! $(command -v dpkg) ]; then
            DEPENDENCY_01='dpkg'
            DEPENDENCY_02=''
            printf "%s\n" "${TMOE_INSTALLATION_COMMAND} ${DEPENDENCY_01}"
            ${TMOE_INSTALLATION_COMMAND} ${DEPENDENCY_01}
            beta_features_install_completed
        fi
        if [ $(command -v dpkg) ]; then
            dpkg -i ./${SELECTION}
        else
            uncompress_deb_file
        fi
        ;;
    esac
    delete_tmoe_deb_file
}
######################
uncompress_deb_file() {
    mkdir -pv .DEB_TEMP_FOLDER
    mv ${SELECTION} .DEB_TEMP_FOLDER
    cd ./.DEB_TEMP_FOLDER
    ar xv ${SELECTION}
    mv ${SELECTION} ../
    if [ -e "data.tar.xz" ]; then
        cd /
        tar -Jxvf ${CURRENT_DIR}/.DEB_TEMP_FOLDER/data.tar.xz ./usr
    elif [ -e "data.tar.gz" ]; then
        cd /
        tar -zxvf ${CURRENT_DIR}/.DEB_TEMP_FOLDER/data.tar.gz ./usr
    fi
    rm -rf ${CURRENT_DIR}/.DEB_TEMP_FOLDER
}
########################
delete_tmoe_deb_file() {
    printf "%s\n" "è¯·é—®æ˜¯å¦éœ€è¦${RED}åˆ é™¤${RESET}å®‰è£…åŒ…æ–‡ä»¶"
    ls -lah ${TMOE_FILE_ABSOLUTE_PATH}
    printf "%s\n" "Do you want to ${RED}delete${RESET} it?"
    do_you_want_to_continue
    rm -fv ${TMOE_FILE_ABSOLUTE_PATH}
}
#################
remove_deb_package() {
    if (whiptail --title "æ‚¨æƒ³è¦å¯¹è¿™ä¸ªå°å¯çˆ±åšä»€ä¹ˆå‘¢ " --yes-button "Backè¿”å›" --no-button "Removeç§»é™¤" --yesno "${PACKAGE_NAME}\næ‚¨æ˜¯æƒ³è¦è¿”å›è¿˜æ˜¯å¸è½½è¿™ä¸ªè½¯ä»¶åŒ…ï¼ŸDo you want to return,or remove this package?â™ª(^âˆ‡^*) " 10 50); then
        deb_installer_menu
    else
        apt purge ${PACKAGE_NAME}
        delete_tmoe_deb_file
        deb_installer_menu
    fi
}
#############
tmoe_deb_file_installer() {
    FILE_EXT_01='deb'
    FILE_EXT_02='DEB'
    check_deb_file_start_dir
    IMPORTANT_TIPS='è‹¥æ‚¨é€‰ä¸­çš„æ˜¯å·²å®‰è£…çš„è½¯ä»¶åŒ…ï¼Œåˆ™å°†è‡ªåŠ¨æ£€æµ‹å¸è½½å‘½ä»¤'
    tmoe_file_manager
    if [ -z ${SELECTION} ]; then
        printf "%s\n" "æ²¡æœ‰æŒ‡å®š${YELLOW}æœ‰æ•ˆ${RESET}çš„${BLUE}æ–‡ä»¶${GREEN}ï¼Œè¯·${GREEN}é‡æ–°${RESET}é€‰æ‹©"
    else
        printf "%s\n" "æ‚¨é€‰æ‹©çš„debæ–‡ä»¶ä¸º${TMOE_FILE_ABSOLUTE_PATH}"
        ls -lah ${TMOE_FILE_ABSOLUTE_PATH}
        deb_file_installer
    fi
}
##################
deb_installer_menu
